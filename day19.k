s:" "~(d:0:"day19").
v:*:'{~s@*x}{(h+*x;h:$["+"~d .*x;$[*|*|x;|0,1 -1@s 1 0+*x;0,1 -1@s 0 1+*x];*|x])}\(0,(*d)?"|";1 0)

{~(x<"A")|x>"Z"}#d ./:v
-1+#v
\\
